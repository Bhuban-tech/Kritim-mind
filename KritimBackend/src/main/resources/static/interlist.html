<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Internship List</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; }
        .internship {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .internship img {
            max-width: 120px;
            max-height: 90px;
            object-fit: contain;
            border: 1px solid #999;
        }
        .info {
            flex-grow: 1;
        }
        .info h3 {
            margin: 0 0 5px 0;
        }
    </style>
</head>
<body>

<h1>Internships</h1>
<div id="internshipList">Loading internships...</div>

<script>
    const apiUrl = 'http://localhost:8080/internships/all';

    function arrayBufferToBase64(buffer) {
        let binary = '';
        const bytes = new Uint8Array(buffer);
        bytes.forEach(b => binary += String.fromCharCode(b));
        return window.btoa(binary);
    }

    async function fetchInternships() {
        try {
            const res = await fetch(apiUrl);
            if (!res.ok) throw new Error('Failed to fetch internships');
            const internships = await res.json();

            const container = document.getElementById('internshipList');
            container.innerHTML = '';

            internships.forEach(item => {
                // The ServiceImage might be base64 string or array, depending on backend serialization.
                // If backend returns byte[] as array of numbers, convert:
                let base64Image = '';
                if (item.ServiceImage) {
                    if (typeof item.ServiceImage === 'string') {
                        base64Image = item.ServiceImage; // if already base64 encoded
                    } else if (Array.isArray(item.ServiceImage)) {
                        // convert array of numbers to base64 string
                        const uint8Array = new Uint8Array(item.ServiceImage);
                        base64Image = btoa(String.fromCharCode(...uint8Array));
                    }
                }

                const div = document.createElement('div');
                div.className = 'internship';
                div.innerHTML = `
          <img src="data:image/png;base64,${base64Image}" alt="${item.ServiceName}" />
          <div class="info">
            <h3>${item.ServiceName}</h3>
            <p>${item.ServiceDescription}</p>
          </div>
        `;
                container.appendChild(div);
            });

            if (internships.length === 0) {
                container.textContent = 'No internships found.';
            }

        } catch (error) {
            document.getElementById('internshipList').textContent = error.message;
        }
    }

    fetchInternships();
</script>

</body>
</html>
